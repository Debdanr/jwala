{
	"variables": [],
	"info": {
		"name": "jwala-create-group",
		"_postman_id": "7cadfc4b-b445-ebe1-49c7-afd261fe4635",
		"description": "",
		"schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
	},
	"item": [
		{
			"name": "a) Authentication & authorization",
			"description": "",
			"item": [
				{
					"name": "login",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"tests[\"Assert response body\"] = jsonData.message === \"SUCCESS\";"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/user/login",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "userName",
									"value": "{{userName}}",
									"type": "text",
									"enabled": true
								},
								{
									"key": "password",
									"value": "{{Password}}",
									"type": "text",
									"enabled": true
								}
							]
						},
						"description": ""
					},
					"response": []
				}
			]
		},
		{
			"name": "b) create group",
			"description": "",
			"item": [
				{
					"name": "create group",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"GroupId\", jsonData.applicationResponseContent.id.id);",
									"tests[\"Assert response body\"] = jsonData.applicationResponseContent.name === postman.getEnvironmentVariable(\"GroupName\");",
									"tests[\"Successful POST request\"] = responseCode.code === 201;",
									"",
									""
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/groups",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{{GroupName}}"
						},
						"description": "create group"
					},
					"response": []
				},
				{
					"name": "create media",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"tests[\"Status code is 201\"] = responseCode.code === 201;",
									"postman.setEnvironmentVariable(\"MediaId\", jsonData.applicationResponseContent.id);"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/media",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "name",
									"value": "Postman-Test-Media",
									"type": "text",
									"enabled": true
								},
								{
									"key": "type",
									"value": "JDK",
									"type": "text",
									"enabled": true
								},
								{
									"key": "mediaArchiveFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/{{jwalaBinaryJdkZip}}",
									"value": ""
								},
								{
									"key": "remoteDir",
									"value": "{{jwalaBinaryJdkDest}}",
									"type": "text",
									"enabled": true
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create duplicate group error",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/groups",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{{GroupName}}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create jvm",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 201\"] = responseCode.code === 201;",
									"var jsonData = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"JvmId\", jsonData.applicationResponseContent.id.id);",
									"tests[\"Assert response body\"] = jsonData.applicationResponseContent.jvmName === postman.getEnvironmentVariable(\"JvmName\");"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/jvms",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\"jvmName\":\"{{JvmName}}\",\"groupIds\":[{\"id\":10,\"groupId\":{{GroupId}}}],\"hostName\":\"{{host}}\",\"statusPath\":\"/tomcat-power.gif\",\"systemProperties\":\"\",\"httpPort\":\"9130\",\"httpsPort\":\"9131\",\"redirectPort\":\"9132\",\"shutdownPort\":\"9133\",\"ajpPort\":\"9134\",\"userName\":\"\",\"encryptedPassword\":\"\",\"jdkMediaId\":\"{{MediaId}}\",\"tomcatVersion\":\"\"}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create duplicate jvm error",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/jvms",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\"jvmName\":\"{{JvmName}}\",\"groupIds\":[{\"id\":1,\"groupId\":{{GroupId}}}],\"hostName\":\"{{host}}\",\"statusPath\":\"/tomcat-power.gif\",\"systemProperties\":\"\",\"httpPort\":\"8000\",\"httpsPort\":8001,\"redirectPort\":8002,\"shutdownPort\":8003,\"ajpPort\":8004,\"userName\":\"\",\"encryptedPassword\":\"\"}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create webserver",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 201\"] = responseCode.code === 201;",
									"var jsonData = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"WebserverId\", jsonData.applicationResponseContent.id.id);",
									"tests[\"Assert response body\"] = jsonData.applicationResponseContent.name === postman.getEnvironmentVariable(\"WebserverName\");"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/webservers",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\"webserverName\":\"{{WebserverName}}\",\"groupIds\":[{\"id\":1,\"groupId\":{{GroupId}}}],\"hostName\":\"{{host}}\",\"portNumber\":\"8080\",\"httpsPort\":\"443\",\"statusPath\":\"/apache_pb.png\",\"svrRoot\":\"\",\"docRoot\":\"\"}]"
						},
						"description": "create the web server with http port 8080 for now and change it to 80 in the update webserver test"
					},
					"response": []
				},
				{
					"name": "create webserver duplicate exception",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/webservers",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\"webserverName\":\"{{WebserverName}}\",\"groupIds\":[{\"id\":1,\"groupId\":{{GroupId}}}],\"hostName\":\"{{host}}\",\"portNumber\":\"80\",\"httpsPort\":\"443\",\"statusPath\":\"/apache_pb.png\",\"svrRoot\":\"\",\"docRoot\":\"\"}]"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create webapp",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"AppId\", jsonData.applicationResponseContent.id.id);",
									"tests[\"Assert response body\"] = jsonData.applicationResponseContent.name === postman.getEnvironmentVariable(\"WebappName\");",
									"tests[\"Successful POST request\"] = responseCode.code === 201;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/applications",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\"name\":\"{{WebappName}}\",\"webappContext\":\"/hello\",\"groupId\":{{GroupId}},\"secure\":true,\"loadBalanceAcrossServers\":true}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Upload war",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/hello-world.war;group={{GroupName}};webApp={{WebappName}}",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "assignToJvms",
									"value": "true",
									"type": "text",
									"enabled": true,
									"warning": ""
								},
								{
									"key": "templateFile",
									"type": "file",
									"enabled": true,
									"warning": "",
									"src": "{{jwalaResourcesDir}}/hello-world.war",
									"value": ""
								},
								{
									"key": "deployPath",
									"value": "${vars['remote.jwala.webapps.dir']}",
									"type": "text",
									"enabled": true,
									"warning": ""
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create webapp duplicate exception",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/applications",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\"name\":\"{{WebappName}}\",\"webappContext\":\"/hello\",\"groupId\":{{GroupId}},\"secure\":true,\"loadBalanceAcrossServers\":true}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "upload httpd.conf to webserver",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 201\"] = responseCode.code === 201;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/template/httpdconf.tpl",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "metaData",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/httpd.json",
									"value": ""
								},
								{
									"key": "tplFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/httpdconf.tpl",
									"value": ""
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "upload setenv template",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 201\"] = responseCode.code === 201;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/template/setenv.tpl",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "metaData",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/setenv.json",
									"value": ""
								},
								{
									"key": "tplFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/setenv.tpl",
									"value": ""
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "upload server xml template",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 201\"] = responseCode.code === 201;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/template/server.xml.tpl",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "metaData",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/server.xml.json",
									"value": ""
								},
								{
									"key": "tplFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/server.xml.tpl",
									"value": ""
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "upload hello xml template",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 201\"] = responseCode.code === 201;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/template/hello.xml.tpl",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "metaData",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/hello.xml.json",
									"value": ""
								},
								{
									"key": "tplFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/hello.xml.tpl",
									"value": ""
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "upload hello xml number of files mismatch error",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/template/hello.xml.tpl",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "metaData",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/hello.xml.json",
									"value": ""
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "upload hello xml under jvms",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 201\"] = responseCode.code === 201;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/template/hello.xml.tpl",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "metaData",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/hello.xml.json",
									"value": ""
								},
								{
									"key": "tplFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/hello.xml.tpl",
									"value": ""
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Add jvms to group",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/groups/{{GroupId}}/jvms",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\"JsonJvms\":{{JvmId}}}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "upload external properties",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/properties",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/test.json",
									"value": ""
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "delete group throw dependency error",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/groups/{{GroupName}}?byName=true",
						"method": "DELETE",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create resource invalid attachments error",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/hello.xml;group={{HealthCheckGroup}};webServer={{HealthCheckWebServer}};jvm={{HealthCheckJvm}};webApp={{HealthCheckApp}}",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "tplFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/hello.xml.tpl",
									"value": ""
								},
								{
									"key": "",
									"value": "",
									"type": "text",
									"enabled": true
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create webapp duplicate exception",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/applications",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\"name\":\"{{WebappName}}\",\"webappContext\":\"/hello\",\"groupId\":{{GroupId}},\"secure\":true,\"loadBalanceAcrossServers\":true}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Error creating resource template pop up",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 500\"] = responseCode.code === 500;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/hello.xml;group={{HealthCheckGroup}};webServer={{HealthCheckWebServer}};jvm={{HealthCheckJvm}};webApp={{HealthCheckApp}}",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "tplFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/hello.xml.tpl",
									"value": ""
								},
								{
									"key": "",
									"value": "",
									"type": "text",
									"enabled": true
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "create resource",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/hello.xml;group={{GroupName}};jvm={{JvmName}};",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "deployPath",
									"value": "d:/stp/app/instances/${jvm.jvmName}/conf/stp/localhost",
									"type": "text",
									"enabled": true
								},
								{
									"key": "contentType",
									"value": "text/xml",
									"type": "text",
									"enabled": true
								},
								{
									"key": "templateFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/hello.xml.tpl"
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "update webserver",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/webservers/",
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\"webserverId\":\"{{WebserverId}}\",\"webserverName\":\"{{WebserverName}}\",\"hostName\":\"{{host}}\",\"portNumber\":\"80\",\"httpsPort\":\"443\",\"statusPath\":\"/apache_pb.png\",\"groupIds\":[{\"groupId\":\"{{GroupId}}\"},{\"groupId\":{{GroupId}}}]}]"
						},
						"description": "update the web server http port from 8080 to 80"
					},
					"response": []
				},
				{
					"name": "upload tomcat-users for manager",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/v1.0/resources/template",
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "metaData",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/tomcat-users.json"
								},
								{
									"key": "templateFile",
									"type": "file",
									"enabled": true,
									"src": "{{jwalaResourcesDir}}/tomcat-users.xml"
								}
							]
						},
						"description": ""
					},
					"response": []
				}
			]
		}
	]
}