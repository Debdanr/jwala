<div class="config-area">
    <div>
        <span class="tool" id="delJvmBtn"></span>
        <span class="tool" id="addJvmBtn"></span>
    </div>
    <div id="jvmDataGrid"></div>
</div>

<div id="jvmEditDialog"></div>

<script type="text/javascript">

$(document).ready(function() {
    validator = $("#jvmAddEditForm").validate({
        ignore: ":hidden"
    });

    /**
     * Callback to handle JVM form specific data transformation
     */
    var jvmJsonFormDataTransformerCallback = function(data) {
        var formJson = {};

        var nameMap = {};
        nameMap["id"] = "jvmId";
        nameMap["name"] = "jvmNameId";
        nameMap["host"] = "hostNameId";
        nameMap["groupInfo"] = "groupNameId";

        $.each(data.applicationResponseContent.content, function(i, obj) {

            if (nameMap[i] !== undefined) {
                if (i !== "groupInfo") {
                    formJson[nameMap[i]] = obj;
                } else {
                    formJson[nameMap[i]] = obj.name;
                }
            }

        });
        return formJson;
    }

    var jvmDataGrid = TocDataTable({theme:"default",
                                headerExt:[
                                  {sTitle:"jvmId", mData:"id.id", bVisible:false}, 
                                  {sTitle:"JVM Name", mData:"jvmName", tocType:"link"}, 
                                  {sTitle:"Host Name", mData:"hostName"}, 
                                  {sTitle:"Group Name", mData:"group.name"}],
                                url:"v1.0/jvms/",
                                editDialog:ModalFormEditDialog({formId:"jvmAddEditForm",
                                                                title:"Edit JVM",
                                                                validator:validator}),
                                jsonFormDataTransformerCallback:jvmJsonFormDataTransformerCallback});

    React.renderComponent(jvmDataGrid,
        document.getElementById("jvmDataGrid"));

    var jvmAddModalDialog = ModalFormAddDialog({formId:"jvmAddEditForm",
                                                title:"Add JVM",
                                                validator:validator});

    React.renderComponent(ModalButton({label:"Add", modalDialog:jvmAddModalDialog, view:jvmDataGrid}),
        document.getElementById("addJvmBtn"));

    React.renderComponent(DeleteItemWidget({dataGrid:jvmDataGrid, url:"v1.0/jvms/"}),
                          document.getElementById("delJvmBtn"));

});

</script>
<div style="display:none">
    <form id="jvmAddEditForm" action="v1.0/jvms">
        <input id="jvmId" name="id" type="hidden" />
        <table>
            <tr>
                <td>Name</td>
            </tr>
            <tr>
                <td><input id="jvmNameId" name="jvmName" type="text" maxlength="100" required></td>
            </tr>
            <tr>
                <td>Host</td>
            </tr>
            <tr>
                <td><input id="hostNameId" name="hostName" type="text" maxlength="50" required/></td>
            </tr>
            <tr>
                <td>
                    Group
                </td>
            </tr>
            <tr>
                <td>
                    <select id="groupNameId" name="groupId">
                        <option value="1">Group 1</option>
                        <option value="2">Group 2</option>
                        <option value="3">Group 3</option>
                        <option value="4">Group 4</option>
                        <option value="5">Group 5</option>
                    </select>
                </td>
            </tr>
        </table>
    </form>
</div>